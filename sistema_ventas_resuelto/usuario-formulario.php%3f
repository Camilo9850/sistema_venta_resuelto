<?php
// Este archivo maneja URLs malformadas como usuario-formulario.php%3f

// Obtener la URL actual
$request_uri = $_SERVER['REQUEST_URI'];
$query_string = $_SERVER['QUERY_STRING'];

// Verificar si estamos en una URL malformada
if (strpos($request_uri, '%3f') !== false || strpos($request_uri, '%3F') !== false) {
    // Limpiar la URL
    $clean_uri = str_replace(['%3f', '%3F'], '?', $request_uri);
    
    // Si hay parámetros después del %3f, convertirlos a query string
    if (preg_match('/(.+?)(?:%3f|%3F)(.*)/', $request_uri, $matches)) {
        $base_path = $matches[1];
        $params = $matches[2];
        
        // Si hay parámetros, redirigir con ellos
        if (!empty($params)) {
            $redirect_url = "/mi_proyecto/php-1/sistema_ventas_resuelto" . $base_path . "?" . $params;
        } else {
            $redirect_url = "/mi_proyecto/php-1/sistema_ventas_resuelto" . $base_path;
        }
        
        header("Location: " . $redirect_url, true, 301);
        exit();
    }
}

// Si llegamos aquí, redirigir al formulario normal
header("Location: /mi_proyecto/php-1/sistema_ventas_resuelto/usuario-formulario.php", true, 301);
exit();
?>
